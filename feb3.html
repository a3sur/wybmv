<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Feb 3</title>
<style>
body {
    margin: 0;
    background: #bbb;
    font-family: Chicago, monospace;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    overflow: hidden;
}

/* Windows */
.window {
    width: 540px;
    background: #eee;
    border: 2px solid #000;
    box-shadow: 6px 6px #555;
    position: relative;
}

.titlebar {
    background: #ddd;
    padding: 4px;
    border-bottom: 2px solid #000;
    text-align: center;
    font-weight: bold;
}

.content {
    padding: 8px;
    text-align: center;
}

/* Canvas */
canvas {
    background: black;
    border: 2px inset #999;
}

/* Hidden */
.hidden { display: none; }

/* Shake screen */
@keyframes shake {
    0% { transform: translate(0,0); }
    25% { transform: translate(-8px,6px); }
    50% { transform: translate(8px,-6px); }
    75% { transform: translate(-6px,-8px); }
    100% { transform: translate(0,0); }
}
.shake {
    animation: shake .15s infinite;
}

/* Boss explosion */
@keyframes explode {
    0% { transform: scale(1); opacity: 1; }
    60% { transform: scale(1.6); opacity: .7; }
    100% { transform: scale(2.2); opacity: 0; }
}
.explode {
    animation: explode .9s ease-out forwards;
}

/* Gallery */
.gallery {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    max-height: 320px;
    overflow-y: auto;
    padding: 8px;
}

.photo {
    width: 100%;
    height: 160px;
    object-fit: cover;
    border: 1px solid #000;
    background: #ccc;
    opacity: 0;
    transform: scale(.9);
    transition: all .5s ease;
}

.photo.visible {
    opacity: 1;
    transform: scale(1);
}

button {
    margin-top: 10px;
    font-family: monospace;
}
</style>
</head>
<body>

<!-- GAME -->
<div class="window" id="gameWindow">
    <div class="titlebar">Galaga</div>
    <div class="content">
        <canvas id="game" width="500" height="320"></canvas>
        <div id="status">Enemies left: 20</div>
    </div>
</div>

<!-- GALLERY -->
<div class="window hidden" id="galleryWindow">
    <div class="titlebar">Photo Gallery</div>
    <div class="content">
        <div class="gallery" id="gallery">
            <!-- 20 placeholders -->
            ${Array.from({length:20},(_,i)=>`<img class="photo" src="https://via.placeholder.com/400?text=${i+1}">`).join("")}
        </div>
        <button onclick="location.href='loveme.html'">Back</button>
    </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const statusText = document.getElementById("status");

let player = { x: 240, y: 285 };
let bullets = [];
let enemyBullets = [];
let enemies = [];
let boss = null;
let phase = "wave";
let loop;

/* Create enemies */
for (let i = 0; i < 20; i++) {
    enemies.push({
        x: 40 + (i % 5) * 90,
        y: 40 + Math.floor(i / 5) * 40,
        baseX: 40 + (i % 5) * 90,
        alive: true,
        dive: false,
        t: 0
    });
}

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") player.x -= 10;
    if (e.key === "ArrowRight") player.x += 10;
    if (e.key === " ") bullets.push({ x: player.x + 10, y: player.y });
});

function update() {
    ctx.clearRect(0,0,500,320);

    /* Player */
    ctx.fillStyle = "lime";
    ctx.fillRect(player.x, player.y, 20, 10);

    /* Player bullets */
    bullets.forEach(b => {
        b.y -= 6;
        ctx.fillRect(b.x, b.y, 2, 6);
    });

    /* Enemy bullets */
    ctx.fillStyle = "orange";
    enemyBullets.forEach(b => {
        b.y += 4;
        ctx.fillRect(b.x, b.y, 3, 6);
    });

    if (phase === "wave") {
        enemies.forEach(e => {
            if (!e.alive) return;

            if (!e.dive && Math.random() < 0.002) {
                e.dive = true;
                e.t = 0;
            }

            if (e.dive) {
                e.t += 0.03;
                e.y += 2;
                e.x = e.baseX + Math.sin(e.t * 4) * 40;
                if (e.y > 260) {
                    e.y = 40;
                    e.dive = false;
                }
            }

            ctx.fillStyle = "red";
            ctx.fillRect(e.x, e.y, 20, 10);

            bullets.forEach(b => {
                if (b.x > e.x && b.x < e.x + 20 && b.y > e.y && b.y < e.y + 10) {
                    e.alive = false;
                    b.y = -10;
                }
            });
        });

        const remaining = enemies.filter(e => e.alive).length;
        statusText.textContent = "Enemies left: " + remaining;

        if (remaining === 0) {
            phase = "boss";
            boss = { x: 200, y: 40, hp: 25 };
        }
    }

    if (phase === "boss") {
        ctx.fillStyle = "purple";
        ctx.fillRect(boss.x, boss.y, 100, 25);

        if (Math.random() < 0.03) {
            enemyBullets.push({ x: boss.x + 50, y: boss.y + 25 });
        }

        bullets.forEach(b => {
            if (b.x > boss.x && b.x < boss.x + 100 && b.y > boss.y && b.y < boss.y + 25) {
                boss.hp--;
                b.y = -10;
            }
        });

        statusText.textContent = "Boss HP: " + boss.hp;

        if (boss.hp <= 0) {
            win();
        }
    }
}

function win() {
    clearInterval(loop);
    document.body.classList.add("shake");

    setTimeout(() => {
        document.getElementById("gameWindow").classList.add("explode");
    }, 600);

    setTimeout(() => {
        document.body.classList.remove("shake");
        document.getElementById("gameWindow").classList.add("hidden");
        document.getElementById("galleryWindow").classList.remove("hidden");
        observeGallery();
    }, 1400);
}

loop = setInterval(update, 30);

/* Gallery scroll reveal */
function observeGallery() {
    const imgs = document.querySelectorAll(".photo");
    const obs = new IntersectionObserver(entries => {
        entries.forEach(e => {
            if (e.isIntersecting) e.target.classList.add("visible");
        });
    }, { threshold: 0.2 });

    imgs.forEach(i => obs.observe(i));
}
</script>

</body>
</html>
